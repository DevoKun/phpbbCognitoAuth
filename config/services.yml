
services:
    mrfg.cogauth.listener:
        class: mrfg\cogauth\event\main_listener
        arguments:
            - '@user'
            - '@request'
            - '@config'
            - '@mrfg.cogauth.cognito'
            - '%mrfg.cogauth.tables.cogauth_session%'
        tags:
            - { name: event.listener }

    mrfg.cogauth.cognito_client_wrapper:
        class: mrfg\cogauth\cognito\cognito_client_wrapper

    mrfg.cogauth.web_token_phpbb:
        class: mrfg\cogauth\cognito\web_token_phpbb
        arguments:
            - '@config'
            - '@cache.driver'
            - '%mrfg.cogauth.jwsk_url_template%'

    mrfg.cogauth.cognito:
        class: mrfg\cogauth\cognito\cognito
        arguments:
            - '@dbal.conn'
            - '@config'
            - '@user'
            - '@log'
            - '@mrfg.cogauth.cognito_client_wrapper'
            - '@mrfg.cogauth.web_token_phpbb'
            - '%mrfg.cogauth.tables.cogauth_session%'

    mrfg.cogauth.controller:
        class: mrfg\cogauth\controller\main
        arguments:
            - '@config'
            - '@user'
            - '@request'
            - '@auth.provider.cogauth'
            - '@mrfg.cogauth.cognito'
            - '@language'

imports:
- { resource: auth.yml }
- { resource: tables.yml }
- { resource: parameters.yml }



